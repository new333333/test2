<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:s="http://www.springframework.org/schema/security"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
    http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-2.0.1.xsd">
    
	<bean id="springAuthenticationBeans" class="com.sitescape.team.spring.security.SpringAuthenticationBeans">
		<property name="globalProviders">
			<map>
				<entry key="ldapOne" value-ref="ldapOne"/>
			</map>
		</property>
		<property name="zoneSpecificProviders">
			<map>
				<entry key="monkeyco">
					<map>
						<entry key="ldapTwo" value-ref="ldapTwo"/>
					</map>
				</entry>
			</map>
		</property>
		<property name="zoneModule"><ref bean="zoneModule"/></property>
	</bean>
	
	<bean id="ssfContextMapper" class="com.sitescape.team.spring.security.SsfContextMapper"/>

    <bean id="contextSourceA" class="org.springframework.security.ldap.DefaultSpringSecurityContextSource">
        <constructor-arg value="ldap://192.168.3.197:389/"/>
    </bean>

    <bean id="contextSourceB" class="org.springframework.security.ldap.DefaultSpringSecurityContextSource">
        <constructor-arg value="ldap://192.168.3.197:389/"/>
    </bean>


    <bean id="ldapOne" class="org.springframework.security.providers.ldap.LdapAuthenticationProvider">
		<constructor-arg>
			<bean class="org.springframework.security.providers.ldap.authenticator.BindAuthenticator">
				<constructor-arg ref="contextSourceA" />
				<property name="userSearch">
					<bean id="userSearchOne" class="org.springframework.security.ldap.search.FilterBasedLdapUserSearch">
					  <constructor-arg index="0" value="o=novell"/>
					  <constructor-arg index="1" value="(uid={0})"/>
					  <constructor-arg index="2" ref="contextSourceA" />
					  <property name="searchSubtree" value="false"/>
					</bean>
				</property>
			</bean>
		</constructor-arg>
		<property name="userDetailsContextMapper"><ref bean="ssfContextMapper"/></property>
    </bean>

    <bean id="ldapTwo" class="org.springframework.security.providers.ldap.LdapAuthenticationProvider">
        <constructor-arg>
			<bean class="org.springframework.security.providers.ldap.authenticator.BindAuthenticator">
				<constructor-arg ref="contextSourceB" />
				<property name="userSearch">
					<bean id="userSearchTwo" class="org.springframework.security.ldap.search.FilterBasedLdapUserSearch">
					  <constructor-arg index="0" value="ou=Quality Assurance,ou=aspendemocouid,o=novell"/>
					  <constructor-arg index="1" value="(uid={0})"/>
					  <constructor-arg index="2" ref="contextSourceB" />
					</bean>
				</property>
			</bean>
		</constructor-arg>
		<property name="userDetailsContextMapper"><ref bean="ssfContextMapper"/></property>
    </bean>

</beans>