<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">
    <changeSet author="jong" context="schema" failOnError="true" id="1">
        <comment>Size limit for any attachment in an email message</comment>
        <addColumn tableName="SS_ZONECONFIG">
            <column name="OUTGOINGATTACHMENTSIZELIMIT" type="NUMBER(19,0)">
                <constraints nullable="true" />
            </column>
        </addColumn>
    </changeSet>
    <changeSet author="jong" context="schema" failOnError="true" id="2">
        <comment>Size limit for the sum of all attachments in an email message</comment>
        <addColumn tableName="SS_ZONECONFIG">
            <column name="OUTGOINGATTACHMENTSUMLIMIT" type="NUMBER(19,0)">
                <constraints nullable="true" />
            </column>
        </addColumn>
    </changeSet>
    <changeSet author="peter" context="schema" failOnError="true" id="3">
        <comment>The binder owning this local template</comment>
        <addColumn tableName="SS_FORUMS">
            <column name="TEMPLATEOWNINGBINDERID" type="NUMBER(19,0)">
                <constraints nullable="true" />
            </column>
        </addColumn>
    </changeSet>
    <changeSet author="peter" context="schema" failOnError="true" id="4">
        <createIndex indexName="TEMPLATEOWNINGBINDERID_BINDER" tableName="SS_FORUMS" unique="false">
            <column name="TEMPLATEOWNINGBINDERID"/>
        </createIndex>
    </changeSet>
    <changeSet author="jong" context="schema" failOnError="true" id="5">
        <comment>XML document stored as compressed bytes</comment>
        <addColumn tableName="SS_CHANGELOGS">
            <column name="XMLBYTES" type="BLOB">
                <constraints nullable="true" />
            </column>
        </addColumn>
    </changeSet>
    <changeSet author="jong" context="schema" failOnError="true" id="6">
        <comment>Identity source type for provisioned users</comment>
        <addColumn tableName="SS_PRINCIPALS">
            <column name="IDENTITYSOURCE" type="NUMBER(10,0)">
                <constraints nullable="true" />
            </column>
        </addColumn>
    </changeSet>
    <changeSet author="peter" context="schema" id="7">
        <createTable tableName="SS_ResourceDriver">
            <column name="ID" type="NUMBER(19,0)">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_SS_RESOURCEDRIVER"/>
            </column>
            <column name="ZONEID" type="NUMBER(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="NAME" type="VARCHAR2(64 CHAR)"/>
            <column name="TYPE" type="VARCHAR2(64 CHAR)"/>
            <column name="READONLY" type="NUMBER(1,0)"/>
            <column name="SYNCHTOPDELETE" type="NUMBER(1,0)"/>
            <column name="PUTREQUIRESCONTENTLENGTH" type="NUMBER(1,0)"/>
            <column name="ALLOWSELFSIGNEDCERTIFICATE" type="NUMBER(1,0)"/>
            <column name="HOSTURL" type="VARCHAR2(255)"/>
            <column name="ROOTPATH" type="VARCHAR2(1024)"/>
            <column name="ACCOUNTNAME" type="VARCHAR2(255 CHAR)"/>
            <column name="PASSWORD" type="VARCHAR2(255 CHAR)"/>
        </createTable>
    </changeSet>
    <changeSet author="peter" context="schema" failOnError="true" id="8">
        <addColumn tableName="SS_ResourceDriver">
            <column name="shareName" type="VARCHAR2(255 CHAR)">
            	<constraints nullable="true" />
            </column>
        </addColumn>
        <addColumn tableName="SS_ResourceDriver">
            <column name="serverName" type="VARCHAR2(255 CHAR)">
            	<constraints nullable="true" />
            </column>
        </addColumn>
        <addColumn tableName="SS_ResourceDriver">
            <column name="serverIP" type="VARCHAR2(255 CHAR)">
            	<constraints nullable="true" />
            </column>
        </addColumn>
        <addColumn tableName="SS_ResourceDriver">
            <column name="volume" type="VARCHAR2(255 CHAR)">
            	<constraints nullable="true" />
            </column>
        </addColumn>
    </changeSet>
    <changeSet author="jong" context="schema" failOnError="true" id="9">
        <comment>Enable external users</comment>
        <addColumn tableName="SS_ZOUNECONFIG">
            <column name="EXTERNALUSERENABLED" type="NUMBER(1,0)">
                <constraints nullable="true" />
            </column>
        </addColumn>
        <comment>Enable OpenID authentication</comment>
        <addColumn tableName="SS_ZOUNECONFIG">
            <column name="OPENIDAUTHENTICATIONENABLED" type="NUMBER(1,0)">
                <constraints nullable="true" />
            </column>
        </addColumn>
        <comment>Enable OpenID self-provisioning</comment>
        <addColumn tableName="SS_ZONECONFIG">
            <column name="OPENIDSELFPROVISIONINGENABLED" type="NUMBER(1,0)">
                <constraints nullable="true" />
            </column>
        </addColumn>
       <comment>Enable synchronization of profiles upon self-provisioning/creation of external user account via OpenID</comment>
        <addColumn tableName="SS_ZONECONFIG">
            <column name="OPENIDSYNCONSELFPROVISION" type="NUMBER(1,0)">
                <constraints nullable="true" />
            </column>
        </addColumn>
       <comment>Enable synchronization of profiles upon login of existing external user via OpenID</comment>
        <addColumn tableName="SS_ZONECONFIG">
            <column name="OPENIDSYNCONLOGIN" type="NUMBER(1,0)">
                <constraints nullable="true" />
            </column>
        </addColumn>
    </changeSet>
    <changeSet author="jong" context="schema" id="10">
        <createTable tableName="SS_OPENIDPROVIDERS">
            <column name="ID" type="CHAR(32)">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_SS_OPENIDPROVIDERS"/>
            </column>
            <column name="ZONEID" type="NUMBER(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="NAME" type="VARCHAR2(64 CHAR)">
                <constraints nullable="false"/>
            </column>
            <column name="TITLE" type="VARCHAR2(128 CHAR)">
                <constraints nullable="false"/>
            </column>
            <column name="URL" type="VARCHAR2(256 CHAR)">
                <constraints nullable="false"/>
            </column>
            <column name="REGEX" type="VARCHAR2(256 CHAR)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="jong" context="schema" id="11">
        <createIndex indexName="NAME_OPENIDPROVIDERS" tableName="SS_OPENIDPROVIDERS" unique="true">
            <column name="ZONEID"/>
            <column name="NAME"/>
        </createIndex>
    </changeSet>
</databaseChangeLog>