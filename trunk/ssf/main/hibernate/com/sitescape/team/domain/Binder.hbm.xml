<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping auto-import="false">
  <class dynamic-update="true" lazy="false" table="SS_Forums" dynamic-insert="false" name="com.sitescape.team.domain.Binder">
    <cache usage="read-write"/>
    <id unsaved-value="null" name="id" type="long" node="@id">
      <generator class="native">
      	<param name="sequence">ss_binder_id_sequence</param>
      </generator>
    </id>
    <discriminator type="string" column="type" length="16"/>
    <version unsaved-value="undefined" name="lockVersion" column="lockVersion" type="long"/>
    <property name="zoneId" not-null="true"/>
	<property name="library"/>
	<property name="deleted"/>
	<property name="uniqueTitles"/>
	<property name="logVersion"/>
	<property name="upgradeVersion" access="field"/>
    <property name="mirrored"/>
    <property name="binderCount"/>
    <property name="resourceDriverName" length="64"/>
    <property name="resourcePath" length="1024"/>
    <many-to-one name="parentBinder">
          <column name="parentBinder" index="owningBinder_Binder"/>
    </many-to-one>
    <many-to-one name="owner" access="field"/>
    <!-- exclude evict, refresh, delete-orphan-->    
    <bag inverse="true" access="field" cascade="persist,merge,delete,save-update,replicate" optimistic-lock="false" lazy="true" name="binders">
        <cache usage="read-write"/>
        <key column="parentBinder"/>
        <one-to-many class="com.sitescape.team.domain.Binder"/>
    </bag>
    <map inverse="true" access="field" cascade="all,delete-orphan" batch-size="4" lazy="true" name="customAttributes">
      <key column="binder"/>
      <map-key type="string" column="name"/>
      <one-to-many class="com.sitescape.team.domain.CustomAttribute"/>
    </map>
    <map inverse="false" table="SS_WorkflowMap" access="field" cascade="all" lazy="true" name="workflowAssociations">
      <key column="binder"/>
      <map-key type="string" column="entryDefinition" length="32"/>
      <many-to-many class="com.sitescape.team.domain.Definition">
      	<column name="workflowDefinition" sql-type="char(32)"/>
      </many-to-many>
    </map>
    <set inverse="true" access="field" cascade="all,delete-orphan" lazy="true" batch-size="4" name="attachments">
      <key column="binder"/>
      <one-to-many class="com.sitescape.team.domain.Attachment"/>
    </set>
    <set inverse="true" access="field" cascade="all,delete-orphan" lazy="true" batch-size="4" name="events">
      <key column="binder" on-delete="cascade"/>
      <one-to-many class="com.sitescape.team.domain.Event"/>
    </set>
    <list inverse="false" access="field" cascade="all" lazy="true" table="SS_DefinitionMap" name="definitions">
      <cache usage="nonstrict-read-write"/>
      <key column="binder"/>
      <index type="integer" column="position"/>
      <many-to-many fetch="join" class="com.sitescape.team.domain.Definition">
        <column name="definition" sql-type="char(32)"/>
      </many-to-many>
    </list>
    <property name="type" length="16" update="false" insert="false"/>
    <property name="name" length="128" />
    <property name="pathName" length="1024"/>
    <component name="notificationDef">
      <property name="teamOn" column="notify_teamOn"/>
	  <bag inverse="false" access="field" cascade="all" optimistic-lock="false" lazy="true" table="SS_Notifications" name="distribution">
      	<key column="binderId" />
 	     <many-to-many fetch="join" class="com.sitescape.team.domain.Principal" column="principalId"/>
    	</bag>
       <property name="emailAddress" column="notify_email" type="org.springframework.orm.hibernate3.support.ClobStringType"/>
      <property name="fromAddress" length="128" column="notify_fromAddress"/>
      <property name="subject" length="128" column="notify_subject"/>
    </component>
    <many-to-one name="posting">
		<column name="posting" sql-type="char(32)"/>
    </many-to-one>

    <property name="properties" type="org.springframework.orm.hibernate3.support.BlobSerializableType"/>
    <property name="functionMembershipInherited" not-null="true"/>
    <property name="definitionsInherited"/>
    <property name="definitionType"/>
    <property name="teamMembershipInherited"/>
    <component name="averageRating" class="com.sitescape.team.domain.AverageRating">
      <property name="average" column="ratings_average" />
      <property name="count" column="ratings_count"/>
    </component>
    <property name="popularity" optimistic-lock="false"/>
    <component name="description">
      <property name="HDescription" column="description_text" type="com.sitescape.team.dao.util.SSClobStringType"/>
      <property name="HFormat" column="description_format"/>
    </component>
    <property name="title" length="255" access="field"/>
    <property name="normalTitle" length="255"/>
    <property name="iconName" length="64"/>    
    <property name="internalId" length="32"/>
      <property name="nextBinderNumber" />
      <component name="binderKey" class="com.sitescape.team.domain.HKey">
        <property name="level" column="binder_level"/>
        <property name="sortKey" length="255" column="binder_sortKey" unique="true"/>
      </component>
    
    <many-to-one access="field" class="com.sitescape.team.domain.Definition" name="entryDef">
      <column name="entryDef" sql-type="char(32)"/>
    </many-to-one>
    <component name="creation" node="creation" class="com.sitescape.team.domain.HistoryStamp">
      <property name="date" column="creation_date" type="timestamp"/>
      <many-to-one class="com.sitescape.team.domain.Principal" embed-xml="false" node="Principal" name="principal">
        <column name="creation_principal"/>
      </many-to-one>
    </component>
    <component name="modification" node="modification" class="com.sitescape.team.domain.HistoryStamp">
      <property name="date" column="modification_date" type="timestamp"/>
      <many-to-one class="com.sitescape.team.domain.Principal" embed-xml="false" node="Principal" name="principal">
        <column name="modification_principal"/>
      </many-to-one>
    </component>
    <subclass name="com.sitescape.team.domain.Folder" node="ss_folder" discriminator-value="folder" dynamic-update="true">
      <many-to-one name="topFolder" />
      <property name="nextEntryNumber"/>
      <property name="entryRootKey">
 		<column name="entryRootKey" sql-type="char(15)"/>
 	  </property>
     </subclass>
    <subclass name="com.sitescape.team.domain.Workspace" discriminator-value="workspace" dynamic-update="true">
    	<property name="searchTitle" length="255" access="field"/>
     <subclass name="com.sitescape.team.domain.ProfileBinder" discriminator-value="profiles" dynamic-update="true"/>
    </subclass>
    <subclass name="com.sitescape.team.domain.TemplateBinder" discriminator-value="template" dynamic-update="true">
  	  <property name="templateTitle" length="128"/>
	   <component name="templateDescription">
   	   <property name="HDescription" column="tDescription_text" type="com.sitescape.team.dao.util.SSClobStringType"/>
   	   <property name="HFormat" column="tDescription_format"/>
   	 </component>
    </subclass>
 
  </class>
  	
</hibernate-mapping>
