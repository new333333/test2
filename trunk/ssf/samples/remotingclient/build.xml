<?xml version="1.0"?>

<project name="wsclient" basedir="." default="usage">
	<property name="project.dir" value="../.." />
	<property name="generated.dir" value="${basedir}/generated" />

	<import file="${project.dir}/build-common.xml"/>

	<!-- This overrides the imported definition -->
	<path id="project.classpath">
		<pathelement path="${classes.dir};${project.dir}/util/classes;${project.dir}/remoting/classes" />
		<pathelement location="${project.dir}/lib/activation.jar" />
		<pathelement location="${project.dir}/lib/mail.jar" />
		<pathelement location="${project.dir}/lib/dom4j.jar" />
		<pathelement location="${project.dir}/lib/spring.jar" />
		<pathelement location="${project.dir}/lib/axis.jar" />
		<pathelement location="${project.dir}/lib/axis-ant.jar" />
		<pathelement location="${project.dir}/lib/jaxrpc.jar" />
		<pathelement location="${project.dir}/lib/commons-logging.jar" />
		<pathelement location="${project.dir}/lib/commons-discovery.jar" />
		<pathelement location="${project.dir}/lib/saaj.jar" />
		<pathelement location="${project.dir}/lib/wsdl4j.jar" />
		<pathelement location="${project.dir}/lib/wss4j.jar" />
		<pathelement location="${project.dir}/lib/addressing.jar" />
		<pathelement location="${project.dir}/lib/bcprov-jdk13-128.jar.jar" />
		<pathelement location="${project.dir}/lib/commons-codec.jar" />
		<pathelement location="${project.dir}/lib/opensaml.jar" />
		<pathelement location="${project.dir}/lib/xalan.jar" />
		<pathelement location="${project.dir}/lib/xmlsec.jar" />
	</path>

	<target name="usage">
		<echo message="readDefinitionGenerated" />
		<echo message="readDefinitionConfigGenerated" />
		<echo message="readBinderGenerated" />
		<echo message="readEntryGenerated" />
		<echo message="addEntryGenerated" />
		<echo message="uploadFileGenerated" />
		<echo message="readDefinitionSpring" />
		<echo message="readDefinitionConfigSpring" />
		<echo message="readBinderSpring" />
		<echo message="readEntrySpring" />
		<echo message="addEntrySpring" />
	</target>
	
	<target name="clean">
		<delete includeEmptyDirs="true" failonerror="false">
			<fileset dir="${classes.dir}" excludes="${classes.dir.excludes}" />
		</delete>
	</target>
	
	<target name="cleanGenerated">
		<delete includeEmptyDirs="true" failonerror="false">
			<fileset dir="${generated.dir}" />
		</delete>
	</target>
	
	<target name="compile">
		<mkdir dir="${classes.dir}" />
		<javac
			classpathref="project.classpath"
			compiler="${javac.compiler}"
			debug="${javac.debug}"
			deprecation="${javac.deprecation}"
			destdir="${classes.dir}"
			fork="${javac.fork}"
			memoryMaximumSize="${javac.memoryMaximumSize}"
			nowarn="${javac.nowarn}">
			<src path="${source.dir}" />
			<src path="${generated.dir}" />
		</javac>
	</target>
	
	<!-- Similar to "compile" target except that this excludes all generated files
	     from compilation. Any program that uses generated files is also excluded. -->
	<target name="compileButGenerated">
		<mkdir dir="${classes.dir}" />
		<javac
			sourcepath="" 
			srcdir="${source.dir}"
			classpathref="project.classpath"
			compiler="${javac.compiler}"
			debug="${javac.debug}"
			deprecation="${javac.deprecation}"
			destdir="${classes.dir}"
			fork="${javac.fork}"
			memoryMaximumSize="${javac.memoryMaximumSize}"
			nowarn="${javac.nowarn}">
			<exclude name="**/jaxrpc/FacadeClient.java"/>
		</javac>
	</target>
	
	<target name="wsdl2java" depends="cleanGenerated" description="Generate client service bindings from WSDL">
		<mkdir dir="${generated.dir}" />
		<axis-wsdl2java
			output="${generated.dir}"
			verbose="true"
			url="http://peace:8080/ssf/ws/Facade?wsdl" >
			<mapping
				namespace="http://peace:8080/ssf/ws/Facade"
				package="com.sitescape.ef.samples.remoting.client.ws.jaxrpc" />
			<mapping
				namespace="urn:SSF"
				package="com.sitescape.ef.samples.remoting.client.ws.jaxrpc" />
		</axis-wsdl2java>
	</target>
	
	<!-- THE FOLLOWING TARGETS ARE USED TO RUN SAMPLE PROGRAMS -->
	
	<target name="readDefinitionSpring" depends="compile">
		<java 
			classname="com.sitescape.ef.samples.remoting.client.FacadeClient"
			classpath="${classes.dir}"
			classpathref="project.classpath"
			fork="true"
			dir="${basedir}"
			failonerror="true">
			<jvmarg value="-Daxis.ClientConfigFile=client_deploy.wsdd"/>
			<arg value="readDefinition"/>
			<!-- id of "discussion" definition -->
			<arg value="402883cc0c10eb75010c10fa9f970002"/>
		</java>
	</target>
	
	<target name="readDefinitionConfigSpring" depends="compile">
		<java 
			classname="com.sitescape.ef.samples.remoting.client.FacadeClient"
			classpath="${classes.dir}"
			classpathref="project.classpath"
			fork="true"
			dir="${basedir}"
			failonerror="true">
			<jvmarg value="-Daxis.ClientConfigFile=client_deploy.wsdd"/>
			<arg value="readDefinitionConfig"/>
		</java>
	</target>
	
	<target name="readBinderSpring" depends="compile">
		<java 
			classname="com.sitescape.ef.samples.remoting.client.FacadeClient"
			classpath="${classes.dir}"
			classpathref="project.classpath"
			fork="true"
			dir="${basedir}"
			failonerror="true">
			<jvmarg value="-Daxis.ClientConfigFile=client_deploy.wsdd"/>
			<arg value="readBinder"/>
			<arg value="74"/>
		</java>
	</target>
	
	<target name="readEntrySpring" depends="compile">
		<java 
			classname="com.sitescape.ef.samples.remoting.client.FacadeClient"
			classpath="${classes.dir}"
			classpathref="project.classpath"
			fork="true"
			dir="${basedir}"
			failonerror="true">
			<jvmarg value="-Daxis.ClientConfigFile=client_deploy.wsdd"/>
			<arg value="readEntry"/>
			<arg value="74"/>
			<arg value="556"/>
		</java>
	</target>
	
	<target name="addEntrySpring" depends="compile">
		<java 
			classname="com.sitescape.ef.samples.remoting.client.FacadeClient"
			classpath="${classes.dir}"
			classpathref="project.classpath"
			fork="true"
			dir="${basedir}"
			failonerror="true">
			<jvmarg value="-Daxis.ClientConfigFile=client_deploy.wsdd"/>
			<arg value="addEntry"/>
			<arg value="74"/>
			<!-- id of "discussion" definition -->
			<arg value="402883cc08da22a50108da5a83260002"/>
		</java>
	</target>
	
	<target name="readDefinitionGenerated" depends="compile">
		<java 
			classname="com.sitescape.ef.samples.remoting.client.ws.jaxrpc.FacadeClient"
			classpath="${classes.dir}"
			classpathref="project.classpath"
			fork="true"
			dir="${basedir}"
			failonerror="true">
			<jvmarg value="-Daxis.ClientConfigFile=client_deploy.wsdd"/>
			<arg value="readDefinition"/>
			<!-- id of "discussion" definition -->
			<arg value="402883cc0c10eb75010c10fa9f970002"/>
		</java>
	</target>
	
	<target name="readDefinitionConfigGenerated" depends="compile">
		<java 
			classname="com.sitescape.ef.samples.remoting.client.ws.jaxrpc.FacadeClient"
			classpath="${classes.dir}"
			classpathref="project.classpath"
			fork="true"
			dir="${basedir}"
			failonerror="true">
			<jvmarg value="-Daxis.ClientConfigFile=client_deploy.wsdd"/>
			<arg value="readDefinitionConfig"/>
		</java>
	</target>
	
	<target name="readBinderGenerated" depends="compile">
		<java 
			classname="com.sitescape.ef.samples.remoting.client.ws.jaxrpc.FacadeClient"
			classpath="${classes.dir}"
			classpathref="project.classpath"
			fork="true"
			dir="${basedir}"
			failonerror="true">
			<jvmarg value="-Daxis.ClientConfigFile=client_deploy.wsdd"/>
			<arg value="readBinder"/>
			<arg value="74"/>
		</java>
	</target>
	
	<target name="readEntryGenerated" depends="compile">
		<java 
			classname="com.sitescape.ef.samples.remoting.client.ws.jaxrpc.FacadeClient"
			classpath="${classes.dir}"
			classpathref="project.classpath"
			fork="true"
			dir="${basedir}"
			failonerror="true">
			<jvmarg value="-Daxis.ClientConfigFile=client_deploy.wsdd"/>
			<arg value="readEntry"/>
			<arg value="74"/>
			<arg value="556"/>
		</java>
	</target>
	
	<target name="addEntryGenerated" depends="compile">
		<java 
			classname="com.sitescape.ef.samples.remoting.client.ws.jaxrpc.FacadeClient"
			classpath="${classes.dir}"
			classpathref="project.classpath"
			fork="true"
			dir="${basedir}"
			failonerror="true">
			<jvmarg value="-Daxis.ClientConfigFile=client_deploy.wsdd"/>
			<arg value="addEntry"/>
			<arg value="74"/>
			<!-- id of "discussion" definition -->
			<arg value="402883cc08da22a50108da5a83260002"/>
		</java>
	</target>
	
	<target name="uploadFileGenerated" depends="compile">
		<java 
			classname="com.sitescape.ef.samples.remoting.client.ws.jaxrpc.FacadeClient"
			classpath="${classes.dir}"
			classpathref="project.classpath"
			fork="true"
			dir="${basedir}"
			failonerror="true">
			<jvmarg value="-Daxis.ClientConfigFile=client_deploy.wsdd"/>
			<arg value="uploadFile"/>
			<arg value="74"/>
			<arg value="482"/>
			<arg value="picture"/>
			<arg value="C:/junk/dog6.gif"/>
		</java>
	</target>
	
</project>